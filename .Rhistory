summarise(sample.size = length(AFDM.MR.mLO2.hr.g))
MR.sample.size.rsqrt98
#Make df for panel labels (A-D)
label_text <- data.frame(
label = c("A", "B", "C", "D"),
measurement.number = c("M1", "M2", "M3", "M4"))
####PANEL A - Adjustment ----
metabolic.plotting.rsqrt98.adjustment <- metabolic.plotting.rsqrt98 %>%
filter(measurement.number == "M1")
#----------Boxplot
MR.boxplot.rsqrt98.adj <- metabolic.plotting.rsqrt98.adjustment %>%
ggplot() +
geom_boxplot(aes(x = Treatment, y = AFDM.MR.mLO2.hr.g, fill = Treatment), outlier.shape = NA) +
scale_fill_manual(values = c("#197BBD", "#05299E" , "#FC814A", "#8D0801")) +
facet_wrap(~measurement.number,
labeller = labeller(measurement.number = measurement.labels)) +
LW_theme +
theme(legend.position = "top",
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()) +
labs(x = "Treatment", y = expression(dot(M)*O[2] ~ "per g of AFDM")) +
ylim(0.1, 0.45) +
stat_n_text(mapping = (aes(x = Treatment, y = AFDM.MR.mLO2.hr.g)),
y.pos = 0.1, color = "black", family = "A") +
#Add panel label
geom_text(label= "A", x = 0.6, y = 0.45,
size = 5, family = "A", color = "black")+
#Add panel shading
annotate("rect", fill = "grey", alpha = 0.3,
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf)
MR.boxplot.rsqrt98.adj
####PANEL B - Heat stress ----
metabolic.plotting.rsqrt98.firstheat <- metabolic.plotting.rsqrt98 %>%
filter(measurement.number == "M2")
#----------Boxplot
MR.boxplot.rsqrt98.heat1 <- metabolic.plotting.rsqrt98.firstheat %>%
ggplot() +
geom_boxplot(aes(x = Treatment, y = AFDM.MR.mLO2.hr.g, fill = Treatment), outlier.shape = NA) +
scale_fill_manual(values = c("#197BBD", "#05299E" , "#FC814A", "#8D0801")) +
facet_wrap(~measurement.number,
labeller = labeller(measurement.number = measurement.labels)) +
LW_theme +
theme(legend.position = "top",
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank()) +
labs(x = "Treatment", y = expression(dot(M)*O[2] ~ "per g of AFDM")) +
ylim(0.1, 0.45) +
stat_n_text(mapping = (aes(x = Treatment, y = AFDM.MR.mLO2.hr.g)),
y.pos = 0.1, color = "black", family = "A") +
#Add panel label
geom_text(label= "B", x = 0.6, y = 0.45,
size = 5, family = "A", color = "black")
MR.boxplot.rsqrt98.heat1
####PANEL C - Heat stress ----
metabolic.plotting.rsqrt98.secondheat <- metabolic.plotting.rsqrt98 %>%
filter(measurement.number == "M3")
#----------Boxplot
MR.boxplot.rsqrt98.heat2 <- metabolic.plotting.rsqrt98.secondheat %>%
ggplot() +
geom_boxplot(aes(x = Treatment, y = AFDM.MR.mLO2.hr.g, fill = Treatment), outlier.shape = NA) +
scale_fill_manual(values = c("#197BBD", "#05299E" , "#FC814A", "#8D0801")) +
facet_wrap(~measurement.number,
labeller = labeller(measurement.number = measurement.labels)) +
LW_theme +
theme(legend.position = "top") +
labs(x = "Treatment", y = expression(dot(M)*O[2] ~ "per g of AFDM")) +
ylim(0.1, 0.45) +
stat_n_text(mapping = (aes(x = Treatment, y = AFDM.MR.mLO2.hr.g)),
y.pos = 0.1, color = "black", family = "A") +
#Add panel label
geom_text(label= "C", x = 0.6, y = 0.45,
size = 5, family = "A", color = "black")
MR.boxplot.rsqrt98.heat2
####PANEL D - Recovery ----
metabolic.plotting.rsqrt98.rec <- metabolic.plotting.rsqrt98 %>%
filter(measurement.number == "M4")
#----------Boxplot
MR.boxplot.rsqrt98.rec <- metabolic.plotting.rsqrt98.rec %>%
ggplot() +
geom_boxplot(aes(x = Treatment, y = AFDM.MR.mLO2.hr.g, fill = Treatment), outlier.shape = NA) +
scale_fill_manual(values = c("#197BBD", "#05299E" , "#FC814A", "#8D0801")) +
facet_wrap(~measurement.number,
labeller = labeller(measurement.number = measurement.labels)) +
LW_theme +
theme(legend.position = "top",
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank()) +
labs(x = "Treatment", y = expression(dot(M)*O[2] ~ "per g of AFDM")) +
ylim(0.1, 0.45) +
stat_n_text(mapping = (aes(x = Treatment, y = AFDM.MR.mLO2.hr.g)),
y.pos = 0.1, color = "black", family = "A") +
#Add panel label
geom_text(label= "D", x = 0.6, y = 0.45,
size = 5, family = "A", color = "black") +
#Add panel shading
annotate("rect", fill = "grey", alpha = 0.3,
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf)
MR.boxplot.rsqrt98.rec
#Plot for MS ----
MS.metabolicrates.plot <- MR.boxplot.rsqrt98.adj + MR.boxplot.rsqrt98.heat1 + MR.boxplot.rsqrt98.heat2 + MR.boxplot.rsqrt98.rec +
plot_layout(nrow = 2, ncol = 2) +
plot_layout(guides = "collect") &
theme(legend.position = "top")
MS.metabolicrates.plot
metabolic.master.aerial <- Metabolic.master.aq.aer %>%
filter(MO2.type == "Aerial") %>%
filter(measurement.number != "M3") %>%
mutate(Treatment = case_when(
water.treatment =="15" & air.treatment=="25" ~ "15°C water/25°C air",
water.treatment =="15" & air.treatment=="30" ~ "15°C water/30°C air",
water.treatment =="20" & air.treatment=="25" ~ "20°C water/25°C air",
water.treatment =="20" & air.treatment=="30" ~ "20°C water/30°C air",
TRUE ~ "other"
)) %>%
mutate(trial.block = case_when(
measurement.number == "M1" ~ "Adjustment",
measurement.number == "M2" ~ "First half heat stress",
measurement.number == "M3" ~ "Second half heat stress",
measurement.number == "M4" ~ "Recovery",
TRUE ~ "OTHER"
))
## Summary table ----
#Make table with the min, max and mean aerial O2 consumption
Aerial.MR.summarytable <- metabolic.master.aerial %>%
group_by(Treatment, trial.block) %>%
summarise(Mean = mean(percent.drop.O2),
SD = sd(percent.drop.O2),
Min = min(percent.drop.O2),
Max = max(percent.drop.O2))
Aerial.MR.summarytable
aerial.aov <- aov(percent.drop.O2 ~ Treatment*measurement.number,
data = metabolic.master.aerial)
shapiro.test(aerial.aov$residuals) #almost Normal
hist(aerial.aov$residuals)
summary(aerial.aov)
TukeyHSD(aerial.aov)
#non-parametric version
kruskal.test(percent.drop.O2 ~ Treatment,
data = metabolic.master.aerial)
kruskal.test(percent.drop.O2 ~ measurement.number,
data = metabolic.master.aerial) #significant
#Make df for panel labels (A-D)
label_text <- data.frame(
label = c("A", "B"),
measurement.number = c("M1", "M2"))
#make variables factors for plotting
metabolic.aerial.plotting <- metabolic.master.aerial
metabolic.aerial.plotting$Treatment <- as.factor(metabolic.aerial.plotting$Treatment)
#----------Boxplot
MR.boxplot.aerial <- metabolic.master.aerial %>%
ggplot() +
geom_boxplot(aes(x = Treatment, y = percent.drop.O2, fill = Treatment)) +
scale_fill_manual(values = c("#197BBD", "#05299E" , "#FC814A", "#8D0801")) +
facet_wrap(~measurement.number,
labeller = labeller(measurement.number = measurement.labels)) +
LW_theme +
theme(legend.position = "top") +
labs(x = "Treatment", y = "% drop in oxygen in air") +
stat_n_text(mapping = (aes(x = Treatment, y = percent.drop.O2)),
y.pos = 0.1, color = "black", family = "A") +
#Add panel labels
geom_text(data = label_text,
mapping = aes(x = -Inf, y = Inf, label = label, family = "A", size = 4),
hjust   = -1,
vjust   = 2,
show.legend = FALSE)
MR.boxplot.aerial
#dev.off() #Clear open plots
rm(list = ls(all=T)) #Clear environment
#Set working directory
library(here)
#Packages for data manipulation
library(dplyr)
library(tidyr)
#Packages for plotting
library(ggplot2)
library(patchwork)
#Packages for statistics and modelling
library(glmmTMB)
library(DHARMa)
library(sjPlot)
PO.collection.May2024 <- read.csv("2024 data/PO_Collection_May-2024.csv")
PO.bodytemps.May2024 <- read.csv("2024 data/PO_Body-temperatures_May-2024.csv")
#Lydia's theme
LW_theme <- theme_classic() +
theme(axis.title.x = element_text(vjust = -1, size = 12),
axis.title.y = element_text(vjust = 2, size = 11),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
panel.background = element_rect(fill = NA, color = "black"))
#Subset the data by the variables we want
PO.collection.May2024.sub <- PO.collection.May2024 %>% #Collection data
subset(select = c(star.ID, ind.number, water.treatment, air.treatment, disc.diameter,
collection.weight))
PO.bodytemps.May2024 <- PO.bodytemps.May2024 %>%
subset(select = c(star.ID, ind.number, water.treatment, air.treatment, trial.day,
trial.period, trial.block, measurement.type,
disc.temp, arm.1, arm.2, arm.3, arm.4, arm.5, ave.star.temp, aquaria.temp,
water.temp, air.temp))
#Merge dfs together
bodytemp.master.May2024 <- merge(PO.collection.May2024.sub, PO.bodytemps.May2024,
by = c("star.ID", "ind.number",
"water.treatment", "air.treatment"))
#Make sure all of the variables are the right structure
bodytemp.master.May2024$water.treatment <- as.factor(bodytemp.master.May2024$water.treatment)
bodytemp.master.May2024$air.treatment <- as.factor(bodytemp.master.May2024$air.treatment)
##RESCALE body size for modelling
bodytemp.master.May2024$disc.diameter_z <- arm::rescale(bodytemp.master.May2024$disc.diameter)
bodytemp.master.May2024 <- bodytemp.master.May2024 %>%
mutate(Treatment = case_when(
water.treatment =="15" & air.treatment=="25" ~ "15°C water/25°C air",
water.treatment =="15" & air.treatment=="30" ~ "15°C water/30°C air",
water.treatment =="20" & air.treatment=="25" ~ "20°C water/25°C air",
water.treatment =="20" & air.treatment=="30" ~ "20°C water/30°C air",
TRUE ~ "other"
))
#New column for trial "blocks"
bodytemp.master.May2024 <- bodytemp.master.May2024 %>%
mutate(trial.block = case_when(
trial.day < 11 ~ "Adjustment",
trial.day > 10 & trial.day < 21 ~ "First half heat stress",
trial.day > 20 & trial.day < 31 ~ "Second half heat stress",
trial.day > 30 ~ "Recovery",
TRUE ~ "OTHER"
))
#Add group column based on odd or even ind.number
bodytemp.master.May2024 <- bodytemp.master.May2024 %>%
mutate(group = case_when(
Treatment == "15°C water/25°C air" & ind.number %% 2 ~ "15C Group 1",
Treatment == "15°C water/25°C air" & ind.number %% 2 == 0 ~ "15C Group 2",
Treatment == "15°C water/30°C air" & ind.number %% 2 ~ "15C Group 1",
Treatment == "15°C water/30°C air" & ind.number %% 2 == 0 ~ "15C Group 2",
Treatment == "20°C water/25°C air" & ind.number %% 2 ~ "20C Group 1",
Treatment == "20°C water/25°C air" & ind.number %% 2 == 0 ~ "20C Group 2",
Treatment == "20°C water/30°C air" & ind.number %% 2 ~ "20C Group 1",
Treatment == "20°C water/30°C air" & ind.number %% 2 == 0 ~ "20C Group 2",
TRUE ~ "other"
)) %>%
drop_na(disc.temp)
# New facet label names for variables
measurement.labs <- c("Emersed", "Submerged")
names(measurement.labs) <- c("emersed", "submerged")
trial.labs <- c("Heat stress", "Recovery")
names(trial.labs) <- c("Heat stress", "Recovery")
bodytemps.submerged <- bodytemp.master.May2024 %>%
filter(measurement.type == "submerged")
# Shapiro-Wilk normality test
shapiro.test(bodytemps.submerged$water.temp) #p < 0.001
# Shapiro-Wilk normality test
shapiro.test(bodytemps.submerged$ave.star.temp) #p < 0.001
bodytemp.submerged.cor <- cor.test(bodytemps.submerged$water.temp, bodytemps.submerged$ave.star.temp,
method = "kendall", alternative = "greater")
bodytemp.submerged.cor #p < 0.001 Sign. correlation between body temp and water temp
# Look at the emersed temperatures (25C versus 30C)
bodytemps.emersed <- bodytemp.master.May2024 %>%
filter(measurement.type == "emersed")
# Shapiro-Wilk normality test
shapiro.test(bodytemps.emersed$air.temp) #p < 0.001
# Shapiro-Wilk normality test
shapiro.test(bodytemps.emersed$ave.star.temp) #p < 0.001
bodytemp.emersed.cor <- cor.test(bodytemps.emersed$air.temp, bodytemps.emersed$ave.star.temp,
method = "kendall", alternative = "greater")
bodytemp.emersed.cor #p < 0.001 Sign. correlation between body temp and air temp
#New df
bodytemp.plotting <- bodytemp.master.May2024 %>%
group_by(water.treatment, air.treatment, Treatment,
trial.period, trial.block, measurement.type) %>%
summarise(mean.BT = mean(ave.star.temp), sd.BT = sd(ave.star.temp),
water.temp = mean(water.temp),
air.temp = mean(air.temp))
#Plot submersion temperatures
bodytemp.plotting.submerged <- bodytemp.plotting %>%
filter(measurement.type == "submerged")
####PANEL A - heat stress ----
bodytemp.plotting.submerged.heatstress <- bodytemp.plotting.submerged %>%
filter(trial.period == "Heat stress")
#plot
bodytemp.plot.PanelA <- bodytemp.plotting.submerged.heatstress %>%
ggplot() +
geom_point(aes(x = Treatment, y = mean.BT, color = Treatment, shape = measurement.type), size = 2) +
geom_errorbar(aes(ymin = mean.BT-sd.BT, ymax = mean.BT+sd.BT,
x = Treatment, color = Treatment), width=.2) +
#Add reference lines for actual air and water temps
geom_abline(intercept = 15, slope=0, linetype = 2, color = "black") +
geom_abline(intercept = 19.2, slope=0, linetype = 2, color = "black") +
scale_color_manual(name = "Treatment",
values = c("#197BBD", "#05299E" , "#FC814A", "#8D0801")) +
scale_shape_manual(values = c(12),
guide = "none") +
facet_grid(~trial.period,
labeller = labeller(trial.period = trial.labs)) +
scale_y_continuous(limits = c(12, 22), breaks = c(15, 20))+
LW_theme +
theme(legend.position = "top",
axis.title.x = element_blank()) +
ylab("Body temperature (°C)") +
#Add labels for sea table temperatures
geom_text(label = "15.0°C\nseawater", x = 4.35, y = 15.7,
size = 3.5, color = "black") +
geom_text(label = "19.2°C\nseawater", x = 4.35, y = 19.9,
size = 3.5, color = "black") +
#Add panel label
geom_text(label= "A", x = 0.6, y = 22,
size = 5, color = "black")
bodytemp.plot.PanelA
####PANEL B - recovery ----
bodytemp.plotting.submerged.recovery <- bodytemp.plotting.submerged %>%
filter(trial.period == "Recovery")
#plot
bodytemp.plot.PanelB <- bodytemp.plotting.submerged.recovery%>%
ggplot() +
geom_point(aes(x = Treatment, y = mean.BT, color = Treatment, shape = measurement.type), size = 2) +
geom_errorbar(aes(ymin = mean.BT-sd.BT, ymax = mean.BT+sd.BT,
x = Treatment, color = Treatment), width=.2) +
#Add reference lines for actual air and water temps
geom_abline(intercept = 14.7, slope=0, linetype = 2, color = "black") +
scale_color_manual(name = "Treatment",
values = c("#197BBD", "#05299E" , "#FC814A", "#8D0801")) +
scale_shape_manual(values = c(12),
guide = "none") +
facet_grid(measurement.type~trial.period,
labeller = labeller(measurement.type = measurement.labs,
trial.period = trial.labs)) +
scale_y_continuous(limits = c(12, 22), breaks = c(15, 20))+
LW_theme +
theme(legend.position = "top",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank()) +
ylab("Body temperature (°C)") +
#Add labels for sea table temperatures
geom_text(label = "14.7°C\nseawater", x = 4.35, y = 15.4,
size = 3.5, color = "black") +
##Add recovery period shading
annotate("rect", fill = "grey", alpha = 0.3,
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf) +
#Add panel label
geom_text(label= "B", x = 0.6, y = 22,
size = 5, color = "black")
bodytemp.plot.PanelB
#Plot emersion temperatures
bodytemp.plotting.emersed <- bodytemp.plotting %>%
filter(measurement.type == "emersed")
#### PANEL C - heat stress ----
bodytemp.plotting.emersed.heatstress <- bodytemp.plotting.emersed %>%
filter(trial.period == "Heat stress")
#plot
bodytemp.plot.PanelC <- bodytemp.plotting.emersed.heatstress %>%
ggplot() +
geom_point(aes(x = Treatment, y = mean.BT, color = Treatment, shape = measurement.type), size = 2) +
geom_errorbar(aes(ymin = mean.BT-sd.BT, ymax = mean.BT+sd.BT,
x = Treatment, color = Treatment), width=.2) +
#Add reference lines for actual air and water temps
geom_abline(intercept = 24.4, slope=0, linetype = 2, color = "black") +
geom_abline(intercept = 28.9, slope=0, linetype = 2, color = "black") +
scale_color_manual(name = "Treatment",
values = c("#197BBD", "#05299E" , "#FC814A", "#8D0801")) +
scale_shape_manual(values = c(9),
guide = "none") +
facet_grid(~trial.period,
labeller = labeller(trial.period = trial.labs)) +
scale_y_continuous(limits = c(17, 30), breaks = c(20, 25, 30))+
LW_theme +
theme(legend.position = "top") +
ylab("Body temperature (°C)") +
#Add labels for sea table temperatures
geom_text(label = "24.4°C\nair", x = 4.4, y = 25.1,
size = 3.5, color = "black") +
geom_text(label = "28.9°C\nair", x = 4.4, y = 29.6,
size = 3.5, color = "black") +
#Add panel label
geom_text(label= "C", x = 0.6, y = 30,
size = 5, color = "black")
bodytemp.plot.PanelC
#### PANEL D - recovery ----
bodytemp.plotting.emersed.recovery <- bodytemp.plotting.emersed %>%
filter(trial.period == "Recovery")
#plot
bodytemp.plot.PanelD <- bodytemp.plotting.emersed.recovery %>%
ggplot() +
geom_point(aes(x = Treatment, y = mean.BT, color = Treatment, shape = measurement.type), size = 2) +
geom_errorbar(aes(ymin = mean.BT-sd.BT, ymax = mean.BT+sd.BT,
x = Treatment, color = Treatment), width=.2) +
#Add reference lines for actual air and water temps
geom_abline(intercept = 20, slope=0, linetype = 2, color = "black") +
scale_color_manual(name = "Treatment",
values = c("#197BBD", "#05299E" , "#FC814A", "#8D0801")) +
scale_shape_manual(values = c(9),
guide = "none") +
facet_grid(measurement.type~trial.period,
labeller = labeller(measurement.type = measurement.labs,
trial.period = trial.labs)) +
scale_y_continuous(limits = c(17, 30), breaks = c(20, 25, 30))+
LW_theme +
theme(legend.position = "top",
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank()) +
#Add labels for sea table temperatures
geom_text(label = "20.0°C\nair", x = 4.4, y = 20.8,
size = 3.5, color = "black") +
##Add recovery period shading
annotate("rect", fill = "grey", alpha = 0.3,
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf)  +
#Add panel label
geom_text(label= "D", x = 0.6, y = 30,
size = 5, color = "black")
bodytemp.plot.PanelD
#Plot for MS ----
MS.bodytemp.plot <- bodytemp.plot.PanelA + bodytemp.plot.PanelB + bodytemp.plot.PanelC + bodytemp.plot.PanelD +
plot_layout(nrow = 2, ncol = 2) +
plot_layout(guides = "collect") &
theme(legend.position = "top")
MS.bodytemp.plot
bodytemp.table <- bodytemp.plotting %>%
subset(select = c(Treatment, trial.period, measurement.type, mean.BT, sd.BT, water.temp, air.temp))
bodytemp.table
#dev.off() #Clear open plots
rm(list = ls(all=T)) #Clear environment
#Set working directory
library(here)
#Packages for data manipulation
library(dplyr)
library(tidyr)
library(tibble)
#Packages for survival analysis
library(survival)
library(ranger)
library(survminer)
#Packages for data visualization
library(ggplot2)
library(ggfortify)
library(patchwork)
library(extrafont)
PO_mortality_June2023 <- read.csv("2023 Data/Pisaster_Mortality-data_June2023.csv")
PO_mortality_2023vs2024 <- read.csv("2023 Data/Pisaster_Mortality-data_2023versus2024.csv")
#Lydia's theme
LW_theme <- theme_classic() +
theme(axis.title.x = element_text(vjust = -1, size = 12),
axis.title.y = element_text(vjust = 2, size = 11),
strip.text = element_text(size = 12),
legend.text = element_text(size = 12),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
panel.background = element_rect(fill = NA, color = "black"))
#---------------------------------Get animal silhouettes from phylopic ----
library(rphylopic)
seastar <- pick_phylopic(name = "Asteriidae", n = 1)
#Compute the survival curve (Kaplan-Meier estimate)
km.fit.June2023 <- survfit(Surv(time, status) ~ water.treatment + air.treatment,
data = PO_mortality_June2023)
print(km.fit.June2023)
# Summary of survival curves
summary(km.fit.June2023)
# Access to the sort summary table
summary(km.fit.June2023)$table
#Access the values returned by survfit()
mortality.PO.June2023 <- data.frame(time = km.fit.June2023$time,
n.risk = km.fit.June2023$n.risk,
n.event = km.fit.June2023$n.event,
n.censor = km.fit.June2023$n.censor,
surv = km.fit.June2023$surv,
upper = km.fit.June2023$upper,
lower = km.fit.June2023$lower)
head(mortality.PO.June2023)
#---------------------------Plot the survival curve (Kaplan Meier curve)
PO.mortality.June2023.Figure <- ggsurvplot(km.fit.June2023, data = PO_mortality_June2023,
# conf.int = TRUE,
#pval = TRUE,
legend.labs = c("15°C water/20°C air", "15°C water/25°C air",
"15°C water/30°C air", "20°C water/20°C air",
"20°C water/25°C air", "20°C water/30°C air"),
legend = c(0.4,0.25),
palette = c("#9DC7C8", "#197BBD", "#05299E" , "#FC6DAB", "#FC814A", "#8D0801"),
legend.title = "Treatment",
break.time.by = 1,
xlab = "Time (days)")
##You can edit the KM curve in ggplot but you have to specify $plot
PO.mortality.June2023.Figure$plot <- PO.mortality.June2023.Figure$plot +
#Add theme to plot
ggplot2::theme(#text = element_text(family = "A"),
axis.title.x = element_text(vjust = -1, size = 12),
axis.title.y = element_text(vjust = 3, size = 12),
axis.text = element_text(size = 8),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 12),
legend.text = element_text(size = 12)) +
ggplot2::ylim(0.5,1.00) +
# guides(color = guide_legend(nrow = 2)) +
#Add p-value
geom_text(label = "p-value < 0.01", x = 0.75, y = 0.52,
size = 4) +
#Add animal outline
add_phylopic(x = 0.75, y = 0.58, img = seastar, alpha = 1, ysize = 0.1)
PO.mortality.June2023.Figure #Look at the plot
